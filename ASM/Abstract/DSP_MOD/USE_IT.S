***********************************************************************
***********										***********
***********										***********
***********  Sample of Use of my DSP SoundTracker Replay	***********
***********										***********
***********	   Runs with most 4/6/8 Voices .MOD		***********
***********										***********
***********	Simplet / ABSTRACT						***********
***********	LESAGE St‚phane - Rue des Monts Jura		***********
***********	01200 Chƒtillon-en-Michaille - FRANCE		***********
***********										***********
***********										***********
***********************************************************************

; 0 for VBL Rout in RVB 50 Hz Only
; 1 for universal Timer A Rout with CIA-Tempos

VBL_Timer	EQU		1

***********************************************************************
***********					Inits				***********
***********************************************************************

		Section	TEXT

		clr.l	-(sp)
		move.w	#$20,-(sp)				; SUPER
		trap		#1						; Gemdos
		addq.l 	#6,sp

		bsr.s	Init_Music
		bmi.s	Error

		IfNe		VBL_Timer
			bsr.s	Init_Music_IT
		Else
			move.l	$70.w,Old_VBL
			move.l	#New_VBL,$70.w
		EndC

***********************************************************************
***********			Waits for a Key				***********
***********************************************************************

 		move.w	#7,-(sp)					; Crawcin
		trap		#1						; Gemdos
		addq.l	#2,sp

***********************************************************************
***********	   Restore Interrupts and Cut DSP Sound		***********
***********************************************************************

		IfNe		VBL_Timer
			bsr.s	Stop_Music_IT
		Else
			move.l	Old_VBL,$70.w
		EndC

		bsr.s	Stop_Music

Error	clr.w 	-(sp)					; PTerm
		trap 	#1						; Gemdos

***********************************************************************
***********		 		VBL Interrupt				***********
***********************************************************************

New_VBL	move.w	#25000,d7
		dbra		d7,*

		bsr.s	SndTrack_IT
		rte

***********************************************************************
***********			SoundTracker Rout				***********
***********************************************************************

		Include	'TRACKER.S'

***********************************************************************
***********				DATA Section				***********
***********************************************************************

		Section	DATA

Module	IncBin	'URA.MOD'		; LAST OF THE DATA SECTION

***********************************************************************
***********				BSS Section				***********
***********************************************************************

		Section	BSS

Old_VBL	ds.l		1
