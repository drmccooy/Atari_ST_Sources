'     COMPAREUR DE FICHIERS V1.0  par David Ducassou 04/11/89
'
'
ON ERROR GOSUB erreur
esp$=SPACE$(39)
d$="A:\*.*"
CLS
PRINT "            BIENVENUE !"
PRINT
@info
PRINT
PRINT
PRINT " AVEZ-VOUS UN RAM-DISK EN  D ?"
PRINT
PRINT "   O  ou  UNE AUTRE TOUCHE"
@key
IF t$="O" OR t$="o"
  d$="D:\*.*"
ENDIF
IF t$=CHR$(27)
  @fin
ENDIF
CLS
@info
PRINT "      CHOISIR LE FICHIER REFERENCE"
REPEAT
  FILESELECT d$,"",n1$
UNTIL n1$<>""
CLS
@info
PRINT "      CHOISIR LE FICHIER DIFFERENT"
REPEAT
  FILESELECT d$,"",n2$
UNTIL n2$<>""
CLS
PRINT "        INFORMATIONS"
PRINT
PRINT "* MON PRG COMPARE 2 FICHIERS:"
PRINT " IL LES LIT SIMULTANEMENT"
PRINT
PRINT "* EN HAUT A DROITE EST AFFICHEE"
PRINT "LA POSITION LUE."
PRINT "* LORSQUE UN OCTET DU FICHIER 2 EST"
PRINT "DIFFERENT DU PREMIER, IL MARQUE:"
PRINT "-LA POSITION DE L'OCTET,"
PRINT "-L'OCTET DU FICHIER 1,"
PRINT "-L'EQUIVALENT ASCII (ET LES EFFETS QUI EN DECOULENT),"
PRINT "-L'OCTET DU FICHIER 2,"
PRINT "-SON EQUIVALENT ASCII."
PRINT "* JE VOUS CONSEILLE DE METTRE VOS"
PRINT "2 FICHIERS DANS UN RAM-DISK,"
PRINT "LE TRAITEMENT EST AINSI PLUS RAPIDE."
PRINT "   ESPACE = FAIRE UNE PAUSE"
PRINT "    ESC   = ARRETER LA PROCEDURE"
PRINT "            ET/OU LE PROGRAMME"
PRINT "   RETURN = EQUIVALENT ASCII OU RIEN"
PRINT AT(1,23);"   H  POUR CONTACT"
@key
IF t$="H"
  CLS
  PRINT "POUR AVOIR LE SOURCE DE CE PROGRAMME"
  PRINT " EN GFA V2.02,"
  PRINT "ENVOYEZ MOI:"
  PRINT "2 DISQUETTES VIERGES 3p1/2 NEUVES,"
  PRINT "VOTRE ADRESSE,"
  PRINT "ET LES TIMBRES POUR LE RETOUR."
  PRINT "JE GARDERAIS UNE DISQUETTE ET"
  PRINT "JE VOUS RENVERAIS LE SOURCE AU PLUS VITE."
  PRINT
  PRINT "DUCASSOU DAVID           04/11/1989"
  PRINT "ROUTE DE MONSEGUR"
  PRINT "40700 HAGETMAU"
  PRINT "FRANCE"
  PRINT
  @key
ENDIF
CLS
PRINT "VOULEZ-VOUS QUE JE METTE LES RESULTATS"
PRINT
PRINT "DANS UN FICHIER AU LIEU DE L'ECRAN ?"
f%=0
@key
IF t$="O" OR t$="o"
  REPEAT
    FILESELECT d$,"",nf$
  UNTIL nf$<>""
  INC f%
ENDIF
as%=0
CLS
PRINT "JE COMPARE...           POS.:"
OPEN "I",#1,n1$
OPEN "I",#2,n2$
l=2
p=1
bi%=0
IF f%=1
  PRINT
  PRINT
  PRINT "     PATIENTEZ !..."
  OPEN "O",#3,nf$
  PRINT #3,"     COMPAREUR DE FICHIERS V1.0"
  PRINT #3," 1:";n1$
  PRINT #3," 2:";n2$
ENDIF
DO
  o1=INP(#1)
  o2=INP(#2)
  PRINT AT(30,1);p
  IF o1<>o2
    IF f%=0
      PRINT AT(1,l);esp$
      IF as%=0
        PRINT AT(1,l);p;"   1:";o1;"=";CHR$(o1);"  2:";o2;"=";CHR$(o2)
      ELSE
        PRINT AT(1,l);p;"   1:";o1;"  2:";o2
      ENDIF
      PRINT esp$
    ENDIF
    IF f%=1
      IF as%=0
        PRINT #3,p;"   1:";o1;"=";CHR$(o1);"  2:";o2;"=";CHR$(o2)
      ELSE
        PRINT #3,p;"   1:";o1;"  2:";o2
      ENDIF
    ENDIF
    INC l
    IF l=24
      l=2
    ENDIF
  ENDIF
  IF o1=o2
    INC bi%
  ENDIF
  t$=INKEY$
  IF t$<>""
    IF t$=" "
      t=INP(2)
    ENDIF
    IF t$=CHR$(27)
      IF f%=1
        PRINT #3," ABANDON AVANT LA FIN"
        PRINT #3," ";bi%;" OCTETS IDENTIQUES A LA MEME PLACE"
      ENDIF
      PRINT " ";bi%;" OCTETS IDENTIQUES A LA MEME PLACE"
      CLOSE
      @key
      @key
      @fin
    ENDIF
    IF t$=CHR$(13) AND as%=0
      as%=1
    ELSE
      as%=0
    ENDIF
  ENDIF
  INC p
LOOP
'
PROCEDURE info
  PRINT "    COMPAREUR DE FICHIERS V1.0"
RETURN
PROCEDURE erreur
  IF ERR=26
    PRINT "     FIN D'UN  ou  DES FICHIERS ATTEINTE !."
    IF f%=1
      PRINT #3," ";bi%;" OCTETS IDENTIQUES A LA MEME PLACE."
    ENDIF
    PRINT " ";bi%;" OCTETS IDENTIQUES A LA MEME PLACE."
    CLOSE
    @key
    @key
    RUN
  ENDIF
  CLOSE
  PRINT " ERREUR NON PREVUE Nø";ERR
  @key
RETURN
PROCEDURE fin
  CLS
  PRINT "VOULEZ-VOUS QUITTER CE PRG ?"
key:
  @key
  IF t$="N" OR t$="n"
    RUN
  ENDIF
  IF t$="O" OR t$="o"
    CLS
    PRINT "       AU REVOIR !"
    END
  ENDIF
  GOTO key
RETURN
PROCEDURE key
  t=INP(2)
  t$=CHR$(t)
RETURN
