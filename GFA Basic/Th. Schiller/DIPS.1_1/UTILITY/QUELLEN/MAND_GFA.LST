'
' Mandelbrotprogramm als Benchmark.
'
' 3 Befehle sind auskommentiert wegen eines Fehlers des GFA-BASIC
' Compilers 3.04. Der berechnete Wert wird stattdessen direkt mit
' OUT 99,n& ausgegeben. (Im Interpreter l„uft auch die andere Version!)
'
'                         DIM array|(256)
idim&=256
CLS
PRINT
PRINT
PRINT
PRINT
PRINT TAB(8);"***********************************************************"
PRINT TAB(8);"Berechnung eines 256x256 Mandelbrotbildes mit GFA-BASIC 3.0"
PRINT TAB(8);"***********************************************************"
PRINT AT(1,10);"Output-Filename ";
INPUT name$
OPEN "O",#99,name$
INPUT "X-Startkoordinate ";xmin
INPUT "X-Endkoordinate ";xmax
INPUT "Y-Startkoordinate ";ymin
ymax=ymin+(xmax-xmin)
PRINT "Y-Endkoordinate ist dann : ";ymax
INPUT "Iterationstiefe [1-255] ";imax&
PRINT
PRINT
'
' Berechnung der internen Konstanten
'
dx=xmax-xmin
dy=ymax-ymin
fx=dx/(idim&-1)
fy=dy/(idim&-1)
ox=xmin
oy=ymin
'
' Erzeugung des Files
'
start=TIMER
FOR iy&=0 TO idim&-1
  PRINT CHR$(27);"A";STR$(iy&+1,3);". Zeile"
  FOR ix&=0 TO idim&-1
    ca=ix&*fx+ox
    cb=iy&*fy+oy
    za=0
    zb=0
    n&=0
    DO WHILE n&<imax&
      a=za*za-zb*zb+ca
      b=2*za*zb+cb
      EXIT IF (a*a+b*b)>=4
      za=a
      zb=b
      INC n&
    LOOP
    OUT #99,n&          ! array|(ix&)=n&
  NEXT ix&
  '                       BPUT #99,V:array|(0),256
NEXT iy&
stop=TIMER
CLOSE #99
PRINT
PRINT "Programmdauer: ";(stop-start)/200;"; Sekunden"
PRINT "Ende nach Taste...";
~INP(2)                              ! Auf Tastendruck warten
END
